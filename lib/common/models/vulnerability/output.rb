# encoding: UTF-8

class Vulnerability
  module Output

    # output the vulnerability
    def output(verbose = false)
      puts
      puts "<vulnerability category=\"critical\" data=\"Title: #{title}\">"
      references.each do |key, urls|
        methodname = "url_#{key}"
        urls.each do |u|
          url = send(methodname, u)
          puts "<reference data=\"Reference: #{url}\"></reference>" if url
        end
      end
      if !fixed_in.nil?
         puts "<fixed category=\"notice\" data=\"Fixed in: #{fixed_in}\"></fixed>"
      end
      puts "</vulnerability>"
    end
  end
end
